<!DOCTYPE html>
<html lang="en">

	<head>
		<title>Offers streaming</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="bootstrap/css/bootstrap.css" rel="stylesheet">
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
        <script src="scripts/jquery.min.js"></script>
        <script src="bootstrap/js/bootstrap.js"></script>
		<script src="scripts/flo.js"></script>
		<script src="bootstrap/js/toastr.min.js"></script>
        <script>
		function getuserdetail(id){
			    $.ajax({
                type: "GET",
                dataType:"JSON",
                url: "user/userprofile?u_id="+id,
                async: false,
				data: {},
                success: function (data) {
				if(data.errno==0){
				location.href="UserProfilePage.html?u_id="+id;}
				}
				});
		}
		function getsellerName()
		{
			
			$.ajax({
                type: "POST",
                dataType:"JSON",
                url: "info/getSellerInfo",
                async: false,
                success: function (data) {
                var i;
               $("#selectbasic").empty();
			$("#selectbasic1").empty();
			var i,j;
			$.each(data, function (index, val) {
				    i = index + 1;
				    $("#selectbasic").append("<option value="+i+">"+val.seller_id+"</option>");
						//alert(val.seller_id); 
					});
			$.each(data, function (index, val) { 
				    j = index + 1;
				    $("#selectbasic1").append("<option value="+j+">"+val.seller_id+"</option>");
						//alert(val.seller_id); 
					});
                return true;
                }     
            });
		}
		function ShowOffer()
{    
			 
            $.ajax({
                type: "POST",
                dataType:"JSON",
                url: "user/all_records",
                async: false,
                success: function (data){
               var i;
                $("#offerinfo").empty();
                $.each(data, function (index, val) {
                i = index + 1;
                //console.log(val);
                $("#offerinfo").append("<tr><td class='col-md-1'></td><td class='col-md-2'><img class='img-rounded' src='"+pic1+"' width='50' height='50' /><b>"+val.sellerFrom+"</b>pts	</td><td class='col-md-1'><br><i class='glyphicon glyphicon-circle-arrow-right'></i></td><td class='col-md-2'><img class='img-rounded' src='"+pic2+"' width='50' height='50' /><b>"+val.sellerTo+"</b>pts</td><td class='col-md-3'><img class='img-rounded' src='"+val.upic1+"' width='50' height='50' /><a href='javascript:getuserdetail(this.id)' id ='"+val.userFrom+"'>"+val.userNameFrom+"</a></td><td class='col-md-1'><br><i class='glyphicon glyphicon-circle-arrow-right'></i></td><td class='col-md-3'><img class='img-rounded' src='"+val.upic2+"' width='50' height='50' /><a href='javascript:getuserdetail(this.id)' id ='"+val.userTo+"'>"+val.userNameTo+"</a></td></tr>");
					});
                return true;
                }   
            });
}
function reloadinfo(){
		var interval = 
		(function(){
		ShowOffer();
					}
				,5000);
		 searchOffer();
}				
		function searchOffer()
{            var cpy1 = $("#selectbasic option:selected").text();
             var cpy2= $("#selectbasic1 option:selected").text();
			 var pic1=getSellerLogo(cpy1);
			 var pic2=getSellerLogo(cpy2);
			 
            $.ajax({
                type: "GET",
                dataType:"JSON",
                url: "user/exchange_streaming",
                async: false,
                data: { company1:cpy1,company2:cpy2 
                },
                success: function (data) {
               var i;
                $("#offerinfo").empty();
                $.each(data.rsm, function (index, val) {
                i = index + 1;
                //console.log(val);
                $("#offerinfo").append(
                "<tr><td class='col-md-1'>"+val.sellerNameFrom+"</td><td class='col-md-1'><b>"+val.pointsFrom+"</b>pts	</td>  <td class='col-md-1'><br><i class='glyphicon glyphicon-circle-arrow-right'></i></td><td class='col-md-2'><b>"+val.pointsTo+"</b>pts</td><td class='col-md-1'>"+val.sellerNameTo+"</td><td class='col-md-3'><img class='img-rounded' src='img/user.png' width='50' height='50' /><a href='#' id ='"+val.userFrom+"' onclick='getuserdetail(this.id)'>"+val.userNameFrom+"</a></td><td class='col-md-1'><br><i class='glyphicon glyphicon-circle-arrow-right'></i></td><td class='col-md-3'><img class='img-rounded' src='img/user.png' width='50' height='50' /><a href='#' id ='"+val.userTo+"' onclick='getuserdetail(this.id)'>"+val.userNameTo+"</a></td></tr>");
					});
                return true;
                }   
            });
}
		</script>
	</head>
	
	<body onLoad="reloadinfo()">
		<div class="container">
		
			<div class="header">

				<!-- Form Name -->
				<legend>Offers Streaming</legend>
			
				<!-- Navbar --> 
				<nav class="navbar navbar-default" style="background-image: url('img/blue.png'); background-position : 10% 10%;" role="navigation">
					<div class="container-fluid">  
						<div class="navbar-header">
							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
									data-target="#mynav">
								<span class="sr-only">change nav</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>	
                                <span class="icon-bar"></span>		   
							</button>
							<a class="navbar-brand" href="#">Exchange Platform</a>
						</div>
						<div class="collapse navbar-collapse" id="mynav">
							<ul class="nav navbar-nav center-block pull-right">
								<li class="nav-item pull-left">
								  <a class="nav-link" href="MainPage.html"><span class="glyphicon glyphicon-home"></span> Home </a>
								</li>
								
                                <li class="nav-item pull-left">
								<a class="nav-link" href="ListOfSellersPage.html"><span class="glyphicon glyphicon-shopping-cart"></span> List of Companies</a>
								</li>	
                                
                                 <li class="nav-item pull-left">
								  <a class="nav-link" href="OfferStreaming.html"><span class="glyphicon glyphicon-time"></span><U> Offers Streaming</U></a>
								</li>
                                
                                <li class="nav-item pull-left">
								  <a class="nav-link" href="RegistrationPage.html"><span class="glyphicon glyphicon-check"></span> Register</a>
								</li>
                                
								<li class="nav-item pull-left">
								  <a class="nav-link" href="LoginPage.html"><span class="glyphicon glyphicon-user"></span> Login</a>
								</li>																	
							</ul>
						</div> 
					</div>
				</nav>
			
            <!-- Website Logo -->
		        <div class="row">
 					<label class="col-md-5 col-sm-4 col-xs-3 control-label" for="Logo"></label>
 					<div class="col-md-2 col-sm-4 col-xs-6">
 					<img class="img-responsive center-block" src="img/logo.png" width="60%" />
  					</div>
				</div>
       </div>
       
          <!--select company-->
              <br>
            <div class="row clearfix">
                <div class="col-md-12 col-md-12 col-xs-12 column">
				<div class="col-md-2 col-sm-4 col-xs-5">
				</div>
                       <div class="col-md-3 col-sm-4 col-xs-5">
                       <form>
                           <div class="form-group">
                                  <select id="selectbasic" name="selectbasic" class="form-control" >
                                      <option value="1">select company</option>
                                      <option value="2">company 1</option>
                                      <option value="3">company 2</option>
                                   </select>
                           </div>
                        </form>
                        </div>
                        <div class="col-md-1 col-sm-2 col-xs-2">
                        <span class="glyphicon glyphicon-circle-arrow-right center-block"></span>
                        </div>
                        <div class="col-md-3 col-sm-4 col-xs-5">
                        <form>
                            <div class="form-group">
                                  <select id="selectbasic1" name="selectbasic1" class="form-control" >
                                      <option value="1">select company</option>
                                      <option value="2">company 1</option>
                                      <option value="3">company 2</option>
                                  </select>
                             </div>
							 
                        </form>
                        </div>
						<div class="col-md-1 col-sm-4 col-xs-5">
							 <button type="button" id="companysubmit" class="btn btn-default btn-info " onclick="searchOffer()"><i class="glyphicon glyphicon-search"></i></button>
					    </div>
                 </div>
            </div>
              
        <!--stream-->
       <br>
        <br>
        <div class="row clearfix">
		<div class="col-md-12 column">
        <div class="table-responsive">
			<table class="table table-hover table-striped">
				<tbody id="offerinfo">
					<tr>
                        <td class="col-md-1">
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>100</b>  
                            pts
                        </td>
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>50</b>  
                            pts
						</td>
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>
						
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>

                       
                    </tr>
					<tr class="success">
						<td class="col-md-1">
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>200</b>  
                            pts
                        </td>
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>100</b>  
                            pts
						</td>
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>
						
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>

					</tr>
					<tr class="error">
						<td class="col-md-1">
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>10</b>  
                            pts
                        </td>
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>500</b>  
                            pts
						</td>
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>
						
                        <td class="col-md-1">
                           <br>
						   
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>


                        
					</tr>
					<tr class="info">
						<td class="col-md-1">
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>80</b>  
                            pts
                        </td>
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						<td class="col-md-2">
                            <img class="img-rounded" src="img/blue.png" width="50" height="50" />
							<b>30</b>  
                            pts
						</td>
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>
						
                        <td class="col-md-1">
                           <br>
                           <i class="glyphicon glyphicon-circle-arrow-right"></i>
                        </td>
						<td class="col-md-3">
							<img class="img-circle" src="img/bonus.png" width="50" height="50" />
                            <a href="#">user nickname</a>
						</td>
					</tr>
				</tbody>
			</table>
        </div>
                       
		</div>
	    </div>
        
       
        </div>
 
 
            
				
		</div>
	</body>
  
</html>
